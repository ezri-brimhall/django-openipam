{% extends "admin/base_site.html" %}
{% load static i18n %}

{% block extrahead %}
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="{% static 'core/css/index.css' %}">

<script type="text/javascript" src="{% static 'chart.js/dist/Chart.min.js' %}"></script>
<script type="text/javascript" src="{% static 'core/js/index.js' %}"></script>
{% endblock %}

{% block extrastyle %}
{{ block.super }}
{% block dashboard_css %}
{% endblock %}
{% endblock %}

{% block page_nav %}{% endblock %}
{% block breadcrumbs %}{% endblock %}
{% block content_title %}{% endblock %}
{% block content %}
<!-- <div class="window">
  <div class="row">
    <div class="col-md-9">
      <div class="panel panel-primary">

        <div class="panel-heading">
          <h3 class="panel-title">Quickview</h3>
        </div>
        <table id="dashboard-stats" class="table table-striped">
          <thead>
            <tr>
              <th>Hostname</th>
              <th>Mac Address</th>
              <th>Expiration</th>
              <th>Description</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for host in hosts %}
            <tr id="{{ host }}">
              <td>{{ host }}</td>
              <td>{{ host.mac }}</td>
              <td id="expire-{{ host }}" {% if host.expire_days <= 30 %}class="near-exp" {% endif %}>
                {% if host.expire_days == 0 %}
                Today
                {% elif host.expire_days < 0 %}
                Expired
                {% elif host.expire_days is None %}
                None
                {% else %}
                {{ host.expire_days }} day{% if host.expire_days > 1 %}s{% endif %}
                {% endif %}
              </td>
              <td>{{ host.description }}</td>
              <td nowrap="nowrap">
                {% if host.is_disabled %}
                <strong>Registration Disabled, please contact the Serive Desk.</strong>
                {% else %}
                <a id="delete-{{ host }}" class="clickable"
                  onclick="deleteHost(this.id, '{{ host.mac_stripped }}')">Delete</a>
                <a id="renew-{{ host }}" class="clickable"
                  onclick="renewHost(this.id, '{{ host.mac_stripped}}')">Renew</a>
                <a href="{% url 'hosts:update' pk=host.mac_stripped %}">Edit</a>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    <div class="col-md-3">
      <div class="panel panel-primary">

        <div class="panel-heading">
          <h3 class="panel-title">Snapshot</h3>
        </div>
        <table id="dashboard-stats" class="table table-inverse">
          <tr>
            <td>Hosts: (Dynamic / Static) </td>
            <td align="right">{{ dynamic_hosts }} / {{ static_hosts }}</td>
          </tr>
          <tr>
            <td>Leases: (Active / Abandoned)</td>
            <td align="right">{{ active_leases }} / {{ abandoned_leases }}</td>
          </tr>
          <tr>
            <td>Networks: (Total / Wireless)</td>
            <td align="right">{{ total_networks }} / {{ wireless_addresses_total }}</td>
          </tr>
          <tr>
            <td>Available Wireless Addresses:</td>
            <td align="right">{{ wireless_addresses_available }}</td>
          </tr>
          <tr>
            <td>DNS Records: (A / CNAME / MX)</td>
            <td align="right">{{ dns_a_records }} / {{ dns_cname_records }} / {{ dns_mx_records }}</td>
          </tr>
          <tr>
            <td>Active Users within 1 year:</td>
            <td align="right">{{ active_users }}</td>
          </tr>
        </table>
      </div>
      <div class="panel panel-primary">
        <div class="panel-heading">
          <h3 class="panel-title">Stats</h3>
        </div>
        <div id="hoststats" class="panel-body">
          <canvas id="stats_chart" width="300" height="300"></canvas>
          <script type="text/javascript">
            $.get('{% url "core:dashboard_stats" %}', function (data) {
              var ctx = $("#stats_chart").get(0).getContext("2d");
              new Chart(ctx, {
                type: 'line', data: data
              });
            });
          </script>
        </div>
      </div>
    </div>
  </div>
</div> -->



<div class="container-fluid">
  <div class="section px-5">
    <div class="overview-card-row">
      <div class="overview-card">
        <h4 class="my-2">Hosts</h4>
        <div class="oc-data">
          <div class="oc-stat">
            <p class="ocstat-number">{{ dynamic_hosts }}</p>
            <p class="oc-description">Dynamic</p>
          </div>
          <div class="border-left oc-stat">
            <p class="ocstat-number">{{ static_hosts }}</p>
            <p class="oc-description">Static</p>
          </div>
        </div>
      </div>
      <div class="overview-card border">
        <h4 class="my-2">Leases</h4>
        <div class="oc-data">
          <div class="oc-stat">
            <p class="ocstat-number">{{ active_leases }}</p>
            <p class="oc-description">Active</p>
          </div>
          <div class="border-left oc-stat">
            <p class="ocstat-number">{{ abandoned_leases }}</p>
            <p class="oc-description">Abandoned</p>
          </div>
        </div>
      </div>
      <div class="overview-card border">
        <h4 class="my-2">Networks</h4>
        <div class="oc-data">
          <div class="oc-stat">
            <p class="ocstat-number">{{ total_networks }}</p>
            <p class="oc-description">Total</p>
          </div>
          <div class="border-left oc-stat">
            <p class="ocstat-number">{{ wireless_addresses_total }}</p>
            <p class="oc-description">Wireless</p>
          </div>
        </div>
      </div>
      <div class="overview-card border">
        <h4 class="my-2">Available Wireless Addresses</h4>
        <div class="oc-data">
          <div class="oc-stat">
            <p class="ocstat-number">{{ wireless_addresses_available }}</p>
            <p class="oc-description">Available</p>
          </div>
        </div>
      </div>
      <div class="overview-card border">
        <h4 class="my-2">DNS</h4>
        <div class="oc-data">
          <div class="oc-stat">
            <p class="ocstat-number">{{ dns_a_records }}</p>
            <p class="oc-description">A</p>
          </div>
          <div class="border-left oc-stat">
            <p class="ocstat-number">{{ dns_cname_records }}</p>
            <p class="oc-description">CNAME</p>
          </div>
          <div class="border-left oc-stat">
            <p class="ocstat-number">{{ dns_mx_records }}</p>
            <p class="oc-description">MX</p>
          </div>
        </div>
      </div>
      <div class="overview-card border">
        <h4 class="my-2">Active Users</h4>
        <div class="oc-data">
          <div class="oc-stat">
            <p class="ocstat-number">{{ active_users }}</p>
            <p class="oc-description">Within one year</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="section section-margin px-5 no-display show-below-1200">
    <div class="row">
      <div class="col-sm-4">
        <div class="profile-card-sm">
          <img src="https://www.gravatar.com/avatar/ac40d7e5a4e07ddbe0c5c1562c6cfea7/?d=mm&size=200"
            data-src="holder.js/200x200" class="pc-img-sm" alt="profile picture">
          <div class="border-left pc-info-sm">
            <h4>User</h4>
            <p>A00000000</p>
            <p>Admin</p>
          </div>
        </div>
      </div>
      <div class="col-sm-4">
        <div class="overview-card">
          <h4 class="my-2">Hosts</h4>
          <div class="oc-data">
            <div class="oc-stat">
              <p class="ocstat-number">{{ user_hosts_dynamic }}</p>
              <p class="oc-description">Dynamic</p>
            </div>
            <div class="border-left oc-stat">
              <p class="ocstat-number">{{ user_hosts_static }}</p>
              <p class="oc-description">Static</p>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-4">
        <div class="overview-card">
          <h4 class="my-2">DNS</h4>
          <div class="oc-data">
            <div class="oc-stat">
              <p class="ocstat-number">{{ user_dns_a }}</p>
              <p class="oc-description">A</p>
            </div>
            <div class="border-left oc-stat">
              <p class="ocstat-number">{{ user_dns_cname }}</p>
              <p class="oc-description">CNAME</p>
            </div>
            <div class="border-left oc-stat">
              <p class="ocstat-number">{{ user_dns_mx }}</p>
              <p class="oc-description">MX</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="section section-margin">
    <div class="row">

      <div id="user-card" class="col-lg-3 hide-below-1200">
        <div class="card">
          <div class="p-0 pt-4 text-center">
            <img src="https://www.gravatar.com/avatar/ac40d7e5a4e07ddbe0c5c1562c6cfea7/?d=mm&size=200"
              data-src="holder.js/200x200" class="profile-card-img" alt="profile picture">
            <h1 class="mt-2">User</h1>
            <p>A0000123 ~ Admin</p>

            <div class="user-stats">
              <h4 class="my-3">Hosts</h4>
              <div class="pcstat-row">
                <div class="pcstat-col border-right p-0 m-0">
                  <p class="pcstat-number">{{ user_hosts_dynamic }}</p>
                  <p>Dynamic</p>
                </div>
                <div class="pcstat-col border-left p-0 m-0">
                  <p class="pcstat-number">{{ user_hosts_static }}</p>
                  <p>Static</p>
                </div>
              </div>
              <h4 class="my-3">DNS</h4>
              <div class="pcstat-row">
                <div class="pcstat-col border-right p-0 m-0">
                  <p class="pcstat-number">{{ user_dns_a }}</p>
                  <p>A</p>
                </div>
                <div class="pcstat-col border-left p-0 m-0">
                  <p class="pcstat-number">{{ user_dns_cname }}</p>
                  <p>CNAME</p>
                </div>
                <div class="pcstat-col border-left p-0 m-0">
                  <p class="pcstat-number">{{ user_dns_mx }}</p>
                  <p>MX</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="data-table" class="col-lg-9 col-xs-12 mt-3 mt-lg-0">
        <div class="card bg-light">
          <div id="dashboard-quick-view">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Hostname</th>
                  <th>Mac Address</th>
                  <th>Expiration</th>
                  <th>Description</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for host in hosts %}
                <tr id="{{ host }}">
                  <td>{{ host }}</td>
                  <td>{{ host.mac }}</td>
                  <td id="expire-{{ host }}" {% if host.expire_days <= 30 %}class="near-exp" {% endif %}>
                    {% if host.expire_days == 0 %}
                    Today
                    {% elif host.expire_days < 0 %}
                    Expired
                    {% elif host.expire_days is None %}
                    None
                    {% else %}
                    {{ host.expire_days }} day{% if host.expire_days > 1 %}s{% endif %}
                    {% endif %}
                  </td>
                  <td>{{ host.description }}</td>
                  <td nowrap="nowrap">
                    {% if host.is_disabled %}
                    <strong>Registration Disabled, please contact the Serive Desk.</strong>
                    {% else %}
                    <a id="delete-{{ host }}" class="clickable"
                      onclick="deleteHost(this.id, '{{ host.mac_stripped }}')">Delete</a>
                    <a id="renew-{{ host }}" class="clickable"
                      onclick="renewHost(this.id, '{{ host.mac_stripped}}')">Renew</a>
                    <a href="{% url 'hosts:update' pk=host.mac_stripped %}">Edit</a>
                    {% endif %}
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}